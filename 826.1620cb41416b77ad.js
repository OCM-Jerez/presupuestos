"use strict";(self.webpackChunkpresupuestos=self.webpackChunkpresupuestos||[]).push([[826],{2826:(P,f,l)=>{l.r(f),l.d(f,{default:()=>E});var g=l(5861),a=l(4946),m=l(6814),u=l(8234),D=l(3546),c=l(1242),_=l(5196);function C(i){return[{children:[{field:"DesCap",width:450,pinned:"left",rowGroup:!0,hide:!0,showRowGroup:"DesCap",cellRenderer:"agGroupCellRenderer",valueGetter:s=>s?.data?`<span style="color: red; font-size: 18px;font-family:var(--fuente-principal); font-weight: bold;margin-left: 0px;">${s.data.CodCap+" - "+s.data.DesCap}</span>`:""},...i.getYearsSelected().map(s=>{let e;return e=1===i.getYearsSelected().length?1:s,{headerName:s.toLocaleString(),children:S(e)}})]}]}function S(i){return[{headerName:"Cr\xe9ditos",children:[{headerName:"Previsiones Iniciales",field:`Iniciales${i}`,hide:!0,cellRenderer:c.qD},{headerName:"Total Modificaciones",field:`Modificaciones${i}`,width:120,hide:!0,cellRenderer:c.qD},{headerName:"Creditos definitivos",field:`Definitivas${i}`,width:150,hide:!1,cellRenderer:c.qD}]},{headerName:"Gastos",children:[{headerName:"Gastos Comprometidos",field:`GastosComprometidos${i}`,width:120,hide:!0,cellRenderer:c.qD},{headerName:"Obligaciones reconocidas netas",field:`ObligacionesReconocidasNetas${i}`,width:135,hide:!0,cellRenderer:c.qD},{headerName:"Pagos",field:`Pagos${i}`,hide:!1,cellRenderer:c.qD},{headerName:"Obligaciones pendientes de pago al final periodo",field:`ObligacionesPendientePago${i}`,width:120,hide:!0,cellRenderer:c.qD}]},{headerName:"Remanente Credito",field:`RemanenteCredito${i}`,hide:!0,cellRenderer:c.qD}]}function v(i,s){return[{headerName:"",children:[{headerName:"Programa",field:"DesPro",showRowGroup:"DesPro",filter:!0,width:700,pinned:"left",columnGroupShow:"closed",cellRenderer:c.lr,valueGetter:e=>e.data.CodPro+" - "+e.data.DesPro},{headerName:"Cr\xe9ditos",children:[{headerName:"Previsiones Iniciales",field:`Iniciales${s}`,columnGroupShow:"closed"},{headerName:"Total Modificaciones",field:`Modificaciones${s}`,width:140,columnGroupShow:"closed"},{headerName:"Creditos definitivos",field:`Definitivas${s}`,width:140,columnGroupShow:"closed"}]},{headerName:"Gastos",children:[{headerName:"Gastos Comprometidos",field:`GastosComprometidos${s}`,width:140,columnGroupShow:"closed"},{headerName:"Obligaciones reconocidas netas",field:`ObligacionesReconocidasNetas${s}`,width:135,columnGroupShow:"closed"},{headerName:"Pagos",field:`Pagos${s}`,columnGroupShow:"closed"},{headerName:"Obligaciones pendientes de pago al final periodo",field:`ObligacionesPendientePago${s}`,width:120,columnGroupShow:"closed"}]},{headerName:"Remanente Credito",field:`RemanenteCredito${s}`,columnGroupShow:"closed"}]}]}function w(i){return[{headerName:"Creditos definitivos",field:`Definitivas${i}`,width:120},{headerName:"Pagos",field:`Pagos${i}`,width:120}]}var G=l(4510),R=l(9303),O=l(5881),T=l(921),h=l(351),N=l(1863);const A=["agGrid"];function x(i,s){if(1&i){const e=a.EpF();a.TgZ(0,"ag-grid-angular",6,7),a.NdJ("gridReady",function(r){a.CHM(e);const d=a.oxw();return a.KtG(d.onGridReady(r))}),a.qZA()}if(2&i){const e=a.oxw();a.Q6J("autoGroupColumnDef",e.autoGroupColumnDef)("groupDisplayType",e.groupDisplayType)("gridOptions",e.gridOptions)}}let E=(()=>{class i{constructor(){this._route=(0,a.f3M)(u.gz),this._location=(0,a.f3M)(m.Ye),this._router=(0,a.f3M)(u.F0),this._dataStoreService=(0,a.f3M)(R.Z),this._hasRowClicked=(0,a.f3M)(O.j),this._prepareDataGastosService=(0,a.f3M)(T._),this._dataStoreFichaProgramaService=(0,a.f3M)(N._),this.avalaibleYearsService=(0,a.f3M)(G.i),this.buttonExpandirColapsar=!0,this.isExpanded=!0,this.titleButtom="",this.showButtomExpanded=!0,this.hasRowClicked$=this._hasRowClicked.currentHasRowClicked,this.hasAppPresupuestaria=!1,this.isDisabled=!0,this.buttonVisible=!0,this._rowData=[],this._subHeaderName="",this._defaultSortModel=[],this._appPresupuestarias=[],this.levelDetails=0,this.autoGroupColumnDef={headerName:"Cap\xedtulo-Econ\xf3mico",field:"DesEco",width:625,pinned:"left",cellRenderer:c.lr,valueGetter:e=>e?.data?`<span style="white-space: pre; color: black; font-family:var(--fuente-principal);font-size: 14px; margin-left: 0px"">${"       "+e.data.CodEco+" - "+e.data.DesEco}</span>`:'<span style="white-space: pre;color: red; font-size: 18px; font-family:var(--fuente-principal);font-weight: bold;text-align: right;padding-left: 425px;">TOTAL PROGRAMA\n\t\t\t\t</span>'},this.groupDisplayType="singleColumn",this.onGridReady=e=>{this._gridApi=e.api,this._columnApi=e.columnApi,this._gridApi.expandAll(),e.columnApi.applyColumnState({state:[{colId:this._dataTable.dataPropertyTable.codField,sort:"asc",sortIndex:0}]})},this.sub=this._route.params.subscribe(e=>{this._path=e.origen})}ngOnInit(){var e=this;return(0,g.Z)(function*(){e._dataTable=e._dataStoreService.dataTable;const t=e.avalaibleYearsService.getYearsSelected(),r=e._dataStoreService.selectedCodeRowFirstLevel.split(" - ")[1];switch(e._path){case"details":e.title="Detalle programa "+r,yield e._CalcDataDetails(),e._columnDefs=C(e.avalaibleYearsService),e._setGridOptions(),e.titleButtom=" Seleccionar app presupuestaria para ver su detalle";break;case"gastan":e.title="Programas que gastan del econ\xf3mico "+r,yield e._CalcDataGastan(),e._columnDefs=v(0,t.toString()),e._setGridOptions(),e.titleButtom="Seleccionar programa para ver su detalle",e.showButtomExpanded=!1;break;case"organico":e.title="Programas que componen el org\xe1nico "+r,yield e._CalcDataGastan(),e._columnDefs=v(0,t.toString()),e._setGridOptions(),e.titleButtom="Seleccionar programa para ver su detalle",e.showButtomExpanded=!1;break;case"appPresupuestaria":console.log("this._dataStoreService.selectedCodeRowFirstLevel",e._dataStoreService.selectedCodeRowFirstLevel),e.title="Aplicaci\xf3n presupuestaria "+r,yield e._CalcDataGastan(),e._columnDefs=v(0,t.toString()),e._setGridOptions(),e.showButtomExpanded=!1}})()}ngOnDestroy(){this.sub.unsubscribe()}_CalcDataDetails(){var e=this;return(0,g.Z)(function*(){e._subHeaderName=e._dataTable.dataPropertyTable.subHeaderName;const t=e._dataStoreService.selectedCodeRowFirstLevel.split(" ")[0];e._rowData=(yield e._prepareDataGastosService.getDataAllYear()).filter(r=>r.CodPro==t),e._rowData=Object.values(e._rowData.reduce((r,d)=>{const o=d.CodEco;return r[o]=r[o]?{...r[o],...d}:{...d},r},{}))})()}_CalcDataGastan(){var e=this;return(0,g.Z)(function*(){e._dataTotalizada=e._dataStoreService.dataTable;let t="";const r=e._dataStoreService.selectedCodeRowFirstLevel.split(" ")[0];t="gastan"===e._path?"gastosEconomicaCapitulos"===e._dataStoreService.dataTable.clasificationType?"CodCap":"CodEco":"CodOrg",e._rowData=(yield e._prepareDataGastosService.getDataAllYear()).filter(o=>o[t]==r),e._dataTotalizada=e._rowData.reduce((o,p)=>(o[p.CodPro]||(o[p.CodPro]={...p}),o),{}),e._rowData=Object.values(e._dataTotalizada)})()}_setGridOptions(){this.gridOptions={defaultColDef:{width:130,sortable:!0,resizable:!0,filter:!0,aggFunc:"sum",cellRenderer:c.QG,headerComponentParams:{template:'<div class="ag-cell-label-container" role="presentation">  <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" ></span>  <div ref="eLabel" class="ag-header-cell-label" role="presentation" >    <span ref="eSortOrder" class="ag-header-icon ag-sort-order"></span>    <span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon"></span>    <span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon"></span>    <span ref="eSortNone" class="ag-header-icon ag-sort-none-icon"></span>    <span ref="eText" class="ag-header-cell-text" role="columnheader" style="white-space: normal;"></span>    <span ref="eFilter" class="ag-header-icon ag-filter-icon"></span>  </div></div>'}},rowData:this._rowData,columnDefs:this._columnDefs,groupDisplayType:"custom",groupSuppressBlankHeader:!0,groupIncludeFooter:!1,groupIncludeTotalFooter:!0,groupHeaderHeight:25,headerHeight:54,suppressAggFuncInHeader:!0,rowSelection:"single",localeText:_,pagination:!0,paginationPageSize:26,onRowClicked:()=>{this.levelDetails+=1;const e=this.agGrid.api.getSelectedNodes();switch(this._dataStoreService.selectedCodeRowFirstLevel=e[0].data.CodPro+" "+e[0].data.DesPro,this._hasRowClicked.change(e[0].key),this.isDisabled=!1,this._path){case"details":this._showAppPresupuestaria(),this.titleButtom="Detalle app presupuestaria seleccionada";break;case"organico":case"gastan":switch(this.levelDetails){case 0:this.titleButtom="Detalle programa seleccionado";break;case 1:this._showProgramDetails(),this.titleButtom="Seleccionar app presupuestaria para ver su detalle";break;case 2:this._showAppPresupuestaria(),this.titleButtom="Detalle app presupuestaria seleccionada"}}}}}_createAppPresupuestarias(){this._rowData.map(e=>{e.appPresupuestaria=e.CodOrg+"-"+e.CodPro+"-"+e.CodEco,this._appPresupuestarias.push(e.appPresupuestaria)})}_filterByAppPresupuestaria(e){const t=this.avalaibleYearsService.getYearsSelected(),r=[];this._appPresupuestarias=this._appPresupuestarias.filter(d=>d===e),this._appPresupuestarias.map(d=>{const o=this._rowData.filter(n=>n.appPresupuestaria===d),p={AplicacionPresupuestaria:d,CodOrg:d.split("-")[0],CodPro:d.split("-")[1],CodEco:d.split("-")[2],CodCap:d.split("-")[2].charAt(0),DesOrg:o[0].DesOrg,DesPro:o[0].DesPro,DesCap:o[0].DesCap,DesEco:o[0].DesEco};t.forEach(n=>{p[`Iniciales${n}`]=(0,h.r)("Iniciales",o)[n],p[`Modificaciones${n}`]=(0,h.r)("Modificaciones",o)[n],p[`Definitivas${n}`]=(0,h.r)("Definitivas",o)[n],p[`GastosComprometidos${n}`]=(0,h.r)("GastosComprometidos",o)[n],p[`ObligacionesReconocidasNetas${n}`]=(0,h.r)("ObligacionesReconocidasNetas",o)[n],p[`Pagos${n}`]=(0,h.r)("Pagos",o)[n],p[`ObligacionesPendientePago${n}`]=(0,h.r)("ObligacionesPendientePago",o)[n],p[`RemanenteCredito${n}`]=(0,h.r)("RemanenteCredito",o)[n]}),r.push(p),this._rowData=r})}_showProgramDetails(){var e=this;return(0,g.Z)(function*(){e.title="Detalle programa "+e._dataStoreService.selectedCodeRowFirstLevel,yield e._CalcDataDetails(),e._columnDefs=C(e.avalaibleYearsService),e._setGridOptions(),e._gridApi.setRowData(e._rowData),e._gridApi.setColumnDefs(e._columnDefs),e._gridApi.expandAll(),e._router.navigateByUrl("/tableProgramaDetails/details"),e.hasAppPresupuestaria=!0})()}_showAppPresupuestaria(){var e=this;return(0,g.Z)(function*(){e.buttonExpandirColapsar=!1;const t=e.agGrid.api.getSelectedNodes();e._hasRowClicked.change(null),console.log(t[0].data),yield e._createAppPresupuestarias(),yield e._filterByAppPresupuestaria(t[0].data.appPresupuestaria),e._columnDefs=function b(i,s){return[{headerName:"Clasificado por aplicaci\xf3n presupuestaria",children:[{headerName:s,field:"DesPro",filter:!1,width:700,pinned:"left",columnGroupShow:"closed",cellRenderer:"agGroupCellRenderer",valueGetter:e=>e.data?e.data.CodPro+"-"+e.data.CodEco+"  "+e.data.DesPro+" - "+e.data.DesEco:null},...i.getYearsSelected().map(e=>({headerName:e.toLocaleString(),children:w(e)}))]}]}(e.avalaibleYearsService,e._subHeaderName),e._setGridOptions(),e.title="Detalle aplicaci\xf3n presupuest\xe1ria: <br> Progr\xe1ma: "+t[0].data.CodPro+"-"+t[0].data.DesPro+"<br> Econ\xf3mico: "+t[0].data.CodEco+"-"+t[0].data.DesEco,e._gridApi.setRowData(e._rowData),e._gridApi.setColumnDefs(e._columnDefs),e._gridApi.expandAll(),e._router.navigateByUrl("/tableProgramaDetails/appPresupuestaria"),e.hasAppPresupuestaria=!1})()}volver(){this.buttonVisible=!0,this._dataStoreService.selectedCodeRowFirstLevel="",this._location.back(),1===this.levelDetails&&this._location.back(),2===this.levelDetails&&(this._location.back(),this._location.back())}ficha(){this._dataStoreFichaProgramaService.setFichaProgramaData(this._rowData),this._location.go("/fichaIndice"),this._router.navigate(["/fichaIndice"])}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=a.Xpm({type:i,selectors:[["app-table-programa-details"]],viewQuery:function(e,t){if(1&e&&a.Gf(A,5),2&e){let r;a.iGM(r=a.CRH())&&(t.agGrid=r.first)}},standalone:!0,features:[a.jDz],decls:9,vars:2,consts:[[2,"margin-top","30px"],[1,"OCM-text--subtitulo",2,"margin-bottom","20px",3,"innerHTML"],[1,"volver"],["type","button",1,"OCM-button",3,"click"],[1,"agGrid"],["id","agGrid","style","width: 100%; height: 90vh; padding-right: 20px; margin-left: 10px","class","ag-theme-balham",3,"autoGroupColumnDef","groupDisplayType","gridOptions","gridReady",4,"ngIf"],["id","agGrid",1,"ag-theme-balham",2,"width","100%","height","90vh","padding-right","20px","margin-left","10px",3,"autoGroupColumnDef","groupDisplayType","gridOptions","gridReady"],["agGrid",""]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a._UZ(1,"h2",1),a.TgZ(2,"div",2)(3,"button",3),a.NdJ("click",function(){return t.ficha()}),a._uU(4,"Ficha"),a.qZA(),a.TgZ(5,"button",3),a.NdJ("click",function(){return t.volver()}),a._uU(6,"Volver"),a.qZA()(),a.TgZ(7,"div",4),a.YNc(8,x,2,3,"ag-grid-angular",5),a.qZA()()),2&e&&(a.xp6(1),a.Q6J("innerHTML",t.title+".",a.oJD),a.xp6(7),a.Q6J("ngIf",t.gridOptions))},dependencies:[m.O5,D.sF,D.N8],styles:[".volver[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;width:95%}"]}),i})()},1863:(P,f,l)=>{l.d(f,{_:()=>m});var g=l(5619),a=l(4946);let m=(()=>{class u{constructor(){this.fichaProgramaSubject=new g.X([{CodCap:"",CodEco:"",CodOrg:"",CodPro:"",Definitivas1:"",DesCap:"",DesEco:"",DesOrg:"",DesPro:"",GastosComprometidos1:"",Iniciales1:"",Modificaciones1:"",ObligacionesPendientePago1:"",ObligacionesReconocidasNetas1:"",Pagos1:"",RemanenteCredito1:"",appPresupuestaria:""}])}getFichaProgramaData(){return this.fichaProgramaSubject.asObservable()}setFichaProgramaData(c){this.fichaProgramaSubject.next(c)}}return u.\u0275fac=function(c){return new(c||u)},u.\u0275prov=a.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);