"use strict";(self.webpackChunkpresupuestos=self.webpackChunkpresupuestos||[]).push([[450],{3450:(v,l,o)=>{o.r(l),o.d(l,{default:()=>C});var e=o(4946),r=o(6814),h=o(1863),s=o(1845),d=o(0),u=o.n(d),g=o(5674);const f=function(n){return{active:n}};function m(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){const p=e.CHM(t).$implicit,b=e.oxw();return e.KtG(b.changeGraph(p.codigo))}),e._uU(1),e.qZA()}if(2&n){const t=c.$implicit,a=e.oxw();e.Q6J("ngClass",e.VKq(2,f,t.codigo===a.activeButton)),e.xp6(1),e.hij(" Cap\xedtulo ",t.name," ")}}o.n(g)()(s),u()(s),s.setOptions({chart:{options3d:{enabled:!0}}});let C=(()=>{class n{constructor(){this._dataStoreFichaProgramaService=(0,e.f3M)(h._),this._location=(0,e.f3M)(r.Ye),this._datos=[],this.cap=[],this.currentGraph=1,this.capitulos=[],this.activeButton=1}ngOnInit(){this._subscription=this._dataStoreFichaProgramaService.getFichaProgramaData().subscribe(t=>{this._datos=t}),this.programa=this._datos[0].DesPro,this.calcCapitulos(),this.cap=this._datos.filter(t=>1==+t.CodCap)}ngOnDestroy(){this._subscription.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{this.graphCapituloGastos(),this.graph()},50)}changeGraph(t){this.activeButton=t,this.currentGraph=t,t>=1&&t<=9&&(this.cap=this._datos.filter(a=>+a.CodCap===t)),setTimeout(()=>{this.graph()},50)}calcCapitulos(){this.capitulos=this._datos.map(t=>({codigo:t.CodCap,descripcion:t.DesCap,name:`${t.CodCap}-${t.DesCap}`,value:t.Definitivas1,recaudado:t.Pagos1})),this.capitulos=this.capitulos.reduce((t,a)=>{const i=t.findIndex(p=>p.name===a.name);return i>-1?(t[i].value+=a.value,t[i].recaudado+=a.recaudado):t.push({codigo:a.codigo,name:a.name,value:a.value,recaudado:a.recaudado}),t},[])}graphCapituloGastos(){const t=this.capitulos.map(a=>[a.name,a.recaudado]);s.setOptions({lang:{thousandsSep:"."}}),s.chart("chart-capitulosGastos",{chart:{type:"pie",options3d:{enabled:!0,alpha:45}},title:{text:"Gastado a la fecha por capitulo de gastos",align:"center",style:{fontSize:"3.5rem"}},subtitle:{text:"",align:"left"},plotOptions:{pie:{innerSize:100,depth:45}},tooltip:{enabled:!1},series:[{type:"pie",name:"Medals",data:t,dataLabels:{enabled:!0,format:'{point.name}<br>{point.y:,.0f} euros<br><span style="color: red">{point.percentage:.1f}%</span>',style:{fontSize:"16px"}}}]})}graph(){s.chart("graph",{chart:{type:"pie",options3d:{enabled:!0,alpha:45}},title:{text:"",align:"center"},subtitle:{text:"",align:"center"},plotOptions:{pie:{innerSize:100,depth:45}},tooltip:{enabled:!1},series:[{type:"pie",name:"Medals",data:this.cap.map(t=>[t.DesEco,t.Pagos1]),dataLabels:{enabled:!0,format:'{point.name}<br>{point.y:,.0f} euros<br><span style="color: red">{point.percentage:.1f}%</span>',style:{fontSize:"12px",fontWeight:"normal"}}}]})}volver(){this._location.back()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ficha-gastos"]],standalone:!0,features:[e.jDz],decls:9,vars:2,consts:[[1,"volver"],["type","button",1,"OCM-button",3,"click"],[2,"font-size","32px","font-weight","bold","text-align","center"],["id","chart-capitulosGastos"],[1,"button-group"],["type","button","class","button",3,"ngClass","click",4,"ngFor","ngForOf"],["id","graph"],["type","button",1,"button",3,"ngClass","click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return a.volver()}),e._uU(2,"Volver"),e.qZA()(),e.TgZ(3,"h1",2),e._uU(4),e.qZA(),e._UZ(5,"div",3),e.TgZ(6,"div",4),e.YNc(7,m,2,4,"button",5),e.qZA(),e._UZ(8,"div",6)),2&t&&(e.xp6(4),e.Oqu(a.programa),e.xp6(3),e.Q6J("ngForOf",a.capitulos))},dependencies:[r.ez,r.mk,r.sg],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px}.button[_ngcontent-%COMP%]{width:125px;height:100px;color:#090909;font-size:14px;border-radius:2em;background:#e8e8e8;border:1px solid #e8e8e8;transition:all .3s;margin-left:5px;font-family:var(--fuente-principal);font-weight:700;cursor:pointer}.button-group[_ngcontent-%COMP%], .graph[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px}.tableDatos[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px;height:300px;background-color:#0ff}.button.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.volver[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;width:95%}"]}),n})()}}]);