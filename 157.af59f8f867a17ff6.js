"use strict";(self.webpackChunkpresupuestos=self.webpackChunkpresupuestos||[]).push([[157],{9157:(j,q,k)=>{k.r(q),k.d(q,{default:()=>i});var L=k(6814),t=k(4946);let f=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-card"]],inputs:{indice:"indice",title:"title",footer:"footer",img:"img"},standalone:!0,features:[t.jDz],decls:7,vars:6,consts:[[1,"OCM-cardV"],[1,"OCM-cardV__indice"],[1,"OCM-cardV__title"],[1,"OCM-cardV__footer"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"span",1),t._uU(2),t.qZA(),t.TgZ(3,"span",2),t._uU(4),t.qZA(),t.TgZ(5,"p",3),t._uU(6),t.qZA()()),2&e&&(t.Jzz("background-image: url('",s.img,"'); background-size: 80px 100px;"),t.xp6(2),t.Oqu(s.indice),t.xp6(2),t.Oqu(s.title),t.xp6(2),t.Oqu(s.footer))}}),a})();var U=k(8972),S=k(5861),O=k(8645),Z=k(9773),P=k(553),N=k(4510),A=k(9303),m=k(8643),h=k(8699),p=k(2314);let n=(()=>{class a{constructor(){this._avalaibleYearsService=(0,t.f3M)(N.i),this._dataStoreService=(0,t.f3M)(A.Z),this._prepareDataTotalesPresupuestoService=(0,t.f3M)(m.X),this._reloadTableService=(0,t.f3M)(h.Y),this._tableService=(0,t.f3M)(p.w),this._capitulosGastos=[],this._CapitulosIngresos=[],this._dataGasto=[],this._unsubscribe$=new O.x,this.DataTotalesPresupuesto={},this.liqDate=""}ngOnInit(){var e=this;return(0,S.Z)(function*(){e._loadData(),e._reloadTableService.reloadTable$.pipe((0,Z.R)(e._unsubscribe$)).subscribe(()=>{e._loadData()})})()}_loadData(){var e=this;return(0,S.Z)(function*(){e._yearsSelected=e._avalaibleYearsService.getYearsSelected()[0],e.liqDate=2023===e._yearsSelected?"(ejecuci\xf3n al "+P.N.liqDate2023+")":"",void 0===e._dataStoreService.dataTable&&(e._dataTable=yield e._tableService.loadData("ingresosEconomicaEconomicos")),yield e.calcSumIngresos(),yield e.calcTotalesPresupuestoIngresos(),yield e.calcSumGastos(),yield e.calcTotalesPresupuestoGastos(),yield e._prepareDataTotalesPresupuestoService.calcTotales(),e.DataTotalesPresupuesto=e._dataStoreService.dataTotalesPresupuesto,yield e.calcIndicadores()})()}calcSumIngresos(){var e=this;return(0,S.Z)(function*(){e._dataTable=yield e._tableService.loadData("ingresosEconomicaCapitulos"),e._dataIngreso=e._dataStoreService.dataTable.rowDataIngresos,e._CapitulosIngresos=[];for(const s of e._dataIngreso)e._CapitulosIngresos.push({name:`${s.CodCap}-${s.DesCap}`,presupuestado:+s.Definitivas1,recaudado:+s.DerechosReconocidosNetos1});e._CapitulosIngresos=e._CapitulosIngresos.reduce((s,r)=>{const g=s.findIndex(_=>_.name===r.name);return g>-1?(s[g].presupuestado+=r.presupuestado,s[g].recaudado+=r.recaudado):s.push({name:r.name,presupuestado:r.presupuestado,recaudado:r.recaudado}),s},[])})()}calcTotalesPresupuestoIngresos(){var e=this;return(0,S.Z)(function*(){e.noFinancieroIngresos=0,e.corrientesIngresos=0,e.capitalIngresos=0,e.financierosIngresos=0,e.noFinancieroIngresos=e._CapitulosIngresos[0].presupuestado+e._CapitulosIngresos[1].presupuestado+e._CapitulosIngresos[2].presupuestado+e._CapitulosIngresos[3].presupuestado+e._CapitulosIngresos[4].presupuestado+e._CapitulosIngresos[5].presupuestado+e._CapitulosIngresos[6].presupuestado,e.corrientesIngresos=e._CapitulosIngresos[0].presupuestado+e._CapitulosIngresos[1].presupuestado+e._CapitulosIngresos[2].presupuestado+e._CapitulosIngresos[3].presupuestado+e._CapitulosIngresos[4].presupuestado,e.capitalIngresos=e._CapitulosIngresos[5].presupuestado+e._CapitulosIngresos[6].presupuestado,e.financierosIngresos=e._CapitulosIngresos[7].presupuestado+e._CapitulosIngresos[8].presupuestado})()}calcSumGastos(){var e=this;return(0,S.Z)(function*(){e._dataTable=yield e._tableService.loadData("gastosEconomicaCapitulos"),e._dataGasto=e._dataStoreService.dataTable.rowDataGastos,e._capitulosGastos=[];for(const s of e._dataGasto)e._capitulosGastos.push({name:`${s.CodCap}-${s.DesCap}`,presupuestado:+s.Definitivas1,gastado:+s.Pagos1});e._capitulosGastos=e._capitulosGastos.reduce((s,r)=>{const g=s.findIndex(_=>_.name===r.name);return g>-1?(s[g].presupuestado+=r.presupuestado,s[g].gastado+=r.gastado):s.push({name:r.name,presupuestado:r.presupuestado,gastado:r.gastado}),s},[])})()}calcTotalesPresupuestoGastos(){var e=this;return(0,S.Z)(function*(){e.noFinancieroGastos=0,e.corrientesGastos=0,e.capitalGastos=0,e.financierosGastos=0,e.noFinancieroGastos=e._capitulosGastos[0].presupuestado+e._capitulosGastos[1].presupuestado+e._capitulosGastos[2].presupuestado+e._capitulosGastos[3].presupuestado+e._capitulosGastos[4].presupuestado+e._capitulosGastos[5].presupuestado+e._capitulosGastos[6].presupuestado,e.corrientesGastos=e._capitulosGastos[0].presupuestado+e._capitulosGastos[1].presupuestado+e._capitulosGastos[2].presupuestado+e._capitulosGastos[3].presupuestado+e._capitulosGastos[4].presupuestado,e.capitalGastos=e._capitulosGastos[5].presupuestado+e._capitulosGastos[6].presupuestado,e.financierosGastos=e._capitulosGastos[7].presupuestado+e._capitulosGastos[8].presupuestado})()}calcIndicadores(){var e=this;return(0,S.Z)(function*(){e.totalPresupuestoIngresos=0,e.totalEjecutadoIngresos=0,e.totalPresupuestoGastos=0,e.totalEjecutadoGastos=0,e.ahorroBruto=0,e.ahorroNeto=0,e.capacidadFinanciacion=0,e.totalPresupuestoIngresos=e.DataTotalesPresupuesto.totalPresupuestoIngresos,e.totalEjecutadoIngresos=e.DataTotalesPresupuesto.totalEjecutadoIngresos,e.totalPresupuestoGastos=e.DataTotalesPresupuesto.totalPresupuestoGastos,e.totalEjecutadoGastos=e.DataTotalesPresupuesto.totalEjecutadoGastos,e.ahorroBruto=e.corrientesIngresos-e.corrientesGastos,e.ahorroNeto=e.corrientesIngresos-e.corrientesGastos-e._capitulosGastos[7].presupuestado,e.capacidadFinanciacion=e.financierosIngresos-e.financierosGastos})()}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-table"]],standalone:!0,features:[t.jDz],decls:108,vars:92,consts:[[1,"datosPresupuestarios"],[1,"tableContainer"],[1,"paleBlueRows"],[2,"font-size","14px","margin-left","10px"]],template:function(e,s){1&e&&(t.TgZ(0,"h3",0),t._uU(1,"Datos presupuestarios a\xf1o seleccionado"),t.qZA(),t.TgZ(2,"div",1)(3,"table",2)(4,"thead")(5,"tr")(6,"th"),t._uU(7),t.qZA(),t.TgZ(8,"th"),t._uU(9,"INGRESOS"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"GASTOS"),t.qZA()()(),t.TgZ(12,"tbody")(13,"tr")(14,"td"),t._uU(15,"TOTAL PRESUPUESTADO"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"currency"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"currency"),t.qZA()(),t.TgZ(22,"tr")(23,"td"),t._uU(24," TOTAL EJECUTADO "),t.TgZ(25,"span"),t._uU(26),t.qZA()(),t.TgZ(27,"td"),t._uU(28),t.ALo(29,"currency"),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.ALo(32,"currency"),t.qZA()(),t.TgZ(33,"tr")(34,"td"),t._uU(35,"Subtotal no financiero "),t.TgZ(36,"span"),t._uU(37," Cap\xedtulos 1 a 7"),t.qZA()(),t.TgZ(38,"td"),t._uU(39),t.ALo(40,"currency"),t.qZA(),t.TgZ(41,"td"),t._uU(42),t.ALo(43,"currency"),t.qZA()(),t.TgZ(44,"tr")(45,"td"),t._uU(46,"Subtotal corriente"),t.TgZ(47,"span"),t._uU(48," Cap\xedtulos 1 a 5"),t.qZA()(),t.TgZ(49,"td"),t._uU(50),t.ALo(51,"currency"),t.qZA(),t.TgZ(52,"td"),t._uU(53),t.ALo(54,"currency"),t.qZA()(),t.TgZ(55,"tr")(56,"td"),t._uU(57,"Subtotal de capital"),t.TgZ(58,"span"),t._uU(59," Cap\xedtulos 6 y 7"),t.qZA()(),t.TgZ(60,"td"),t._uU(61),t.ALo(62,"currency"),t.qZA(),t.TgZ(63,"td"),t._uU(64),t.ALo(65,"currency"),t.qZA()(),t.TgZ(66,"tr")(67,"td"),t._uU(68,"Subtotal financiero"),t.TgZ(69,"span"),t._uU(70," Cap\xedtulos 8 y 9"),t.qZA()(),t.TgZ(71,"td"),t._uU(72),t.ALo(73,"currency"),t.qZA(),t.TgZ(74,"td"),t._uU(75),t.ALo(76,"currency"),t.qZA()()()(),t.TgZ(77,"table",2)(78,"thead")(79,"tr")(80,"th"),t._uU(81,"INDICADORES PRESUPUESTARIOS"),t.qZA(),t._UZ(82,"th"),t.qZA()(),t.TgZ(83,"tbody")(84,"tr")(85,"td"),t._uU(86," AHORRO BRUTO "),t.TgZ(87,"span"),t._uU(88," Ingresos corrientes - gastos corrientes"),t.qZA()(),t.TgZ(89,"td"),t._uU(90),t.ALo(91,"currency"),t.qZA()(),t.TgZ(92,"tr")(93,"td"),t._uU(94," AHORRO NETO "),t.TgZ(95,"span",3),t._uU(96," Ahorro neto - capitulo 9 de gastos"),t.qZA()(),t.TgZ(97,"td"),t._uU(98),t.ALo(99,"currency"),t.qZA()(),t.TgZ(100,"tr")(101,"td"),t._uU(102," CAPACIDAD/NECESIDAD DE FINANCIACI\xd3N "),t.TgZ(103,"span"),t._uU(104," Ingresos no financieros - gastos no financieros"),t.qZA()(),t.TgZ(105,"td"),t._uU(106),t.ALo(107,"currency"),t.qZA()()()()()),2&e&&(t.xp6(7),t.hij("EJECUCI\xd3N ",s.liqDate,""),t.xp6(10),t.Oqu(t.gM2(18,17,s.totalPresupuestoIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(21,22,s.totalPresupuestoGastos,"EUR","","1.0-0")),t.xp6(6),t.hij(" ",s.liqDate,""),t.xp6(2),t.Oqu(t.gM2(29,27,s.totalEjecutadoIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(32,32,s.totalEjecutadoGastos,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(40,37,s.noFinancieroIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(43,42,s.noFinancieroGastos,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(51,47,s.corrientesIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(54,52,s.corrientesGastos,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(62,57,s.capitalIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(65,62,s.capitalGastos,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(73,67,s.financierosIngresos,"EUR","","1.0-0")),t.xp6(3),t.Oqu(t.gM2(76,72,s.financierosGastos,"EUR","","1.0-0")),t.xp6(15),t.Oqu(t.gM2(91,77,s.ahorroBruto,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(99,82,s.ahorroNeto,"EUR","","1.0-0")),t.xp6(8),t.Oqu(t.gM2(107,87,s.capacidadFinanciacion,"EUR","","1.0-0")))},dependencies:[L.H9],styles:[".datosPresupuestarios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100 hw;color:#000;font-weight:700;font-family:var(--fuente-principal);font-size:4rem;text-align:center;margin-bottom:20px}.tableContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;margin-top:20px;margin-bottom:20px;width:96%;height:100%}table.paleBlueRows[_ngcontent-%COMP%]{border:2px solid #0f0101;width:30vh;height:200px;text-align:center;border-collapse:collapse;margin-left:20px}table.paleBlueRows[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table.paleBlueRows[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #ffffff;padding:3px 2px}table.paleBlueRows[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:1.6rem}table.paleBlueRows[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background:#d0e4f5}table.paleBlueRows[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#003df6;border-bottom:5px solid #ffffff}table.paleBlueRows[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#fff;text-align:center;border-left:2px solid #ffffff}table.paleBlueRows[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-left:none}table.paleBlueRows[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#333;background:#d0e4f5;border-top:3px solid #444444}table.paleBlueRows[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px}"]}),a})();var l=k(4664),v=k(1845),C=k(5674),T=k.n(C),y=k(7337),I=k.n(y);T()(v),I()(v);let d=(()=>{class a{constructor(){this._dataStoreService=(0,t.f3M)(A.Z),this._reloadTableService=(0,t.f3M)(h.Y),this._tableService=(0,t.f3M)(p.w),this._data=[],this._unsubscribe$=new O.x}ngOnInit(){this._reloadTableService.reloadTable$.pipe((0,l.w)(()=>this._showGraph("Ingresos")),(0,l.w)(()=>this._showGraph("Gastos")),(0,Z.R)(this._unsubscribe$)).subscribe(),this._showGraph("Ingresos").then(()=>this._showGraph("Gastos"))}_showGraph(e){var s=this;return(0,S.Z)(function*(){yield s._calcSum(e),v.chart(e,{accessibility:{enabled:!1},title:{text:`<span style= 'font-size: 25px'>${e}</span>`},subtitle:{text:""},tooltip:{headerFormat:null,pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: {point.weight} "},series:[{type:"sankey",name:e,borderColor:"#1a1a1a",borderWidth:1,colors:["#1E90FF","#1eff8d","#ce9eff","#1eff8d","#1eff8d","#1eff8d","#1eff8d","#ce9eff","#ce9eff","#ce9eff","#ce9eff"],keys:["from","to","weight"],data:s._data,dataLabels:{style:{color:"#1a1a1a",textOutline:"none"}}}]})})()}_calcSum(e){var s=this;return(0,S.Z)(function*(){yield s._tableService.loadData("ingresosEconomicaCapitulos");const g={};return s._dataStoreService.dataTable["rowData"+e].forEach(_=>{const u=`${_.CodCap}-${_.DesCap}`;g[u]||(g[u]={name:u,value:0}),g[u].value+=_.Definitivas1}),s._data=Object.values(g).map(_=>({from:"Ingresos"===e?_.name:"Presupuesto",to:"Ingresos"===e?"Presupuesto":_.name,weight:_.value})),s._data})()}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-sankey-graphs"]],standalone:!0,features:[t.jDz],decls:3,vars:0,consts:[[1,"graph2"],["id","Ingresos"],["id","Gastos"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1)(2,"div",2),t.qZA())},dependencies:[L.ez],styles:["@media screen and (max-width: 3399.98px){.graph2[_ngcontent-%COMP%]{display:flex;margin:20px 20px 0;min-width:100%}#Ingresos[_ngcontent-%COMP%], #Gastos[_ngcontent-%COMP%]{width:50%;max-width:46%;min-width:46%;height:550px}}@media screen and (max-width: 575.98px){#Ingresos[_ngcontent-%COMP%], #Gastos[_ngcontent-%COMP%]{height:350px}}"]}),a})();function c(a,o){if(1&a&&(t.TgZ(0,"div",4),t._UZ(1,"app-card",5),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("indice",e.indice)("title",e.title)("footer",e.footer)("img",e.img)}}let i=(()=>{class a{constructor(){this.items=[{indice:"1.",title:"La recaudaci\xf3n local",footer:"Se realiza a trav\xe9s de impuestos directos, como el impuesto de bienes inmuebles (IBI) o el de veh\xedculos de tracci\xf3n mec\xe1nica (IVTM), y de tasas.",img:"../../assets/img/vision-global/busget-stream-1.webp"},{indice:"2.",title:"Otras fuentes de ingresos",footer:"El dinero recaudado localmente se complementa con las transferencias de la Administraci\xf3n General del Estado y de la Junta de Andaluc\xeda, que son las encargadas de recaudar otros ingresos como el IVA y el IRPF.",img:"../../assets/img/vision-global/busget-stream-2.webp"},{indice:"3.",title:"Gastos",footer:"El ayuntamiento utiliza el dinero recaudado, junto con otras fuentes de financiaci\xf3n como la deuda, para mantener los servicios p\xfablicos y la infraestructura de la ciudad.",img:"../../assets/img/vision-global/busget-stream-3.webp"}]}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-vision-global"]],standalone:!0,features:[t.jDz],decls:7,vars:2,consts:[[1,"OCM-title"],[1,"flex-container-cards"],["class","flex-items",4,"ngFor","ngForOf"],[3,"multiYears"],[1,"flex-items"],[3,"indice","title","footer","img"]],template:function(e,s){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Visi\xf3n global"),t.qZA(),t.TgZ(2,"div",1),t.YNc(3,c,2,4,"div",2),t.qZA(),t._UZ(4,"app-checkbox",3)(5,"app-sankey-graphs")(6,"app-table")),2&e&&(t.xp6(3),t.Q6J("ngForOf",s.items),t.xp6(1),t.Q6J("multiYears",!1))},dependencies:[L.ax,f,U.b,n,d]}),a})()},7337:(j,q,k)=>{var L,t,f;f=function(f){function U(S,O,Z,P){S.hasOwnProperty(O)||(S[O]=P.apply(null,Z),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:O,module:S[O]}})))}U(f=f?f._modules:{},"Series/NodesComposition.js",[f["Core/Series/SeriesRegistry.js"],f["Core/Utilities.js"]],function(S,O){const{series:{prototype:Z,prototype:{pointClass:{prototype:P}}}}=S,{defined:N,extend:A,find:m,merge:h,pick:p}=O;var n;return function(l){function v(){return this.data=[].concat(this.points||[],this.nodes),Z.destroy.apply(this,arguments)}function C(){this.nodes&&(this.nodes.forEach(d=>{d.destroy()}),this.nodes.length=0),Z.setData.apply(this,arguments)}function T(d){const c=arguments,i=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==d&&i.forEach(a=>{a&&a.series&&(P.setState.apply(a,c),a.isNode||(a.fromNode.graphic&&P.setState.apply(a.fromNode,c),a.toNode&&a.toNode.graphic&&P.setState.apply(a.toNode,c)))}),P.setState.apply(this,c)}function y(d,c,i,a){const o=this.series.options.nodes,e=this.series.options.data,s=e&&e.length||0,r=e&&e[this.index];P.update.call(this,d,!this.isNode&&c,i,a),this.isNode&&(d=(o||[]).reduce((g,_,u)=>this.id===_.id?u:g,-1),a=h(o&&o[d]||{},e&&e[this.index]||{}),e&&(r?e[this.index]=r:e.length=s),o?0<=d?o[d]=a:o.push(a):this.series.options.nodes=[a],p(c,!0)&&this.series.chart.redraw(i))}const I=[];l.compose=function(d,c){return O.pushUnique(I,d)&&((d=d.prototype).setNodeState=T,d.setState=T,d.update=y),O.pushUnique(I,c)&&((d=c.prototype).destroy=v,d.setData=C),c},l.createNode=function(d){const c=this.pointClass;var i=(o,e)=>m(o,s=>s.id===e);let a=i(this.nodes,d);if(!a){i=this.options.nodes&&i(this.options.nodes,d);const o=(new c).init(this,A({className:"highcharts-node",isNode:!0,id:d,y:1},i));o.linksTo=[],o.linksFrom=[],o.getSum=function(){let e=0,s=0;return o.linksTo.forEach(r=>{e+=r.weight||0}),o.linksFrom.forEach(r=>{s+=r.weight||0}),Math.max(e,s)},o.offset=function(e,s){let r=0;for(let g=0;g<o[s].length;g++){if(o[s][g]===e)return r;r+=o[s][g].weight}},o.hasShape=function(){let e=0;return o.linksTo.forEach(s=>{s.outgoing&&e++}),!o.linksTo.length||e!==o.linksTo.length},o.index=this.nodes.push(o)-1,a=o}return a.formatPrefix="node",a.name=a.name||a.options.id||"",a.mass=p(a.options.mass,a.options.marker&&a.options.marker.radius,this.options.marker&&this.options.marker.radius,4),a},l.destroy=v,l.generatePoints=function(){const d=this.chart,c={};Z.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(i=>{i.linksFrom.length=0,i.linksTo.length=0,i.level=i.options.level}),this.points.forEach(i=>{N(i.from)&&(c[i.from]||(c[i.from]=this.createNode(i.from)),c[i.from].linksFrom.push(i),i.fromNode=c[i.from],d.styledMode?i.colorIndex=p(i.options.colorIndex,c[i.from].colorIndex):i.color=i.options.color||c[i.from].color),N(i.to)&&(c[i.to]||(c[i.to]=this.createNode(i.to)),c[i.to].linksTo.push(i),i.toNode=c[i.to]),i.name=i.name||i.id},this),this.nodeLookup=c},l.setNodeState=T,l.updateNode=y}(n||(n={})),n}),U(f,"Series/Sankey/SankeyPoint.js",[f["Core/Series/Point.js"],f["Core/Series/SeriesRegistry.js"],f["Core/Utilities.js"]],function(S,O,Z){({seriesTypes:{column:O}}=O);const{defined:P}=Z;return class N extends O.prototype.pointClass{constructor(){super(...arguments),this.toNode=this.series=this.options=this.nodeY=this.nodeX=this.mass=this.linksTo=this.linksFrom=this.linkBase=this.level=this.fromNode=this.className=void 0}applyOptions(m,h){return S.prototype.applyOptions.call(this,m,h),P(this.options.level)&&(this.options.column=this.column=this.options.level),this}getClassName(){return(this.isNode?"highcharts-node ":"highcharts-link ")+S.prototype.getClassName.call(this)}getFromNode(){let h,m=-1;for(let p=0;p<this.linksTo.length;p++){const n=this.linksTo[p];n.fromNode.column>m&&n.fromNode!==this&&(h=n.fromNode,m=h.column)}return{fromNode:h,fromColumn:m}}setNodeColumn(){P(this.options.column)||(this.column=0===this.linksTo.length?0:this.getFromNode().fromColumn+1)}isValid(){return this.isNode||"number"==typeof this.weight}}}),U(f,"Series/Sankey/SankeySeriesDefaults.js",[],function(){return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,opacity:1,minLinkWidth:0,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}}),U(f,"Series/Sankey/SankeyColumnComposition.js",[f["Core/Utilities.js"]],function(S){const{defined:O,relativeLength:Z}=S;var P;return function(N){N.compose=function(m,h){return m.sankeyColumn=new A(m,h),m};class A{constructor(h,p){this.points=h,this.series=p}getTranslationFactor(h){const p=this.points,n=p.slice(),l=h.options.minLinkWidth||0;let C,v=0,T=(h.chart.plotSizeY||0)-(h.options.borderWidth||0)-(p.length-1)*h.nodePadding;for(;p.length;){for(v=T/p.sankeyColumn.sum(),h=!1,C=p.length;C--;)p[C].getSum()*v<l&&(p.splice(C,1),T-=l,h=!0);if(!h)break}return p.length=0,n.forEach(y=>{p.push(y)}),v}top(h){const p=this.series,n=p.nodePadding,l=this.points.reduce(function(v,C){return 0<v&&(v+=n),v+Math.max(C.getSum()*h,p.options.minLinkWidth||0)},0);return((p.chart.plotSizeY||0)-l)/2}left(h){const p=this.series,n=p.chart,l=p.options.equalNodes,v=n.inverted?n.plotHeight:n.plotWidth,C=p.nodePadding,T=this.points.reduce(function(y,I){return 0<y&&(y+=C),y+(l?v/I.series.nodes.length-C:Math.max(I.getSum()*h,p.options.minLinkWidth||0))},0);return((n.plotSizeX||0)-Math.round(T))/2}sum(){return this.points.reduce(function(h,p){return h+p.getSum()},0)}offset(h,p){const n=this.points,l=this.series,v=l.nodePadding;let C=0;if(l.is("organization")&&h.hangsFrom)return{absoluteTop:h.hangsFrom.nodeY};for(let y=0;y<n.length;y++){var T=n[y].getSum();const I=Math.max(T*p,l.options.minLinkWidth||0),d=h.options[l.chart.inverted?"offsetHorizontal":"offsetVertical"],c=h.options.offset||0;if(T=T?I+v:0,n[y]===h)return{relativeTop:C+(O(d)?Z(d,I):Z(c,T))};C+=T}}}N.SankeyColumnAdditions=A}(P||(P={})),P}),U(f,"Series/TreeUtilities.js",[f["Core/Color/Color.js"],f["Core/Utilities.js"]],function(S,O){const{extend:P,isArray:N,isNumber:A,isObject:m,merge:h,pick:p}=O;return{getColor:function(n,l){const v=l.index;var C=l.mapOptionsToLevel;const T=l.parentColor,y=l.parentColorIndex,I=l.series;var d=l.colors;const c=l.siblings;var i=I.points,a=I.chart.options.chart;let o;var e;let s;if(n){if(i=i[n.i],n=C[n.level]||{},C=i&&n.colorByPoint){o=i.index%(d?d.length:a.colorCount);var r=d&&d[o]}I.chart.styledMode||(d=i&&i.options.color,a=n&&n.color,(e=T)&&(e=(e=n&&n.colorVariation)&&"brightness"===e.key&&v&&c?S.parse(T).brighten(v/c*e.to).get():T),e=p(d,a,r,e,I.color)),s=p(i&&i.options.colorIndex,n&&n.colorIndex,o,y,l.colorIndex)}return{color:e,colorIndex:s}},getLevelOptions:function(n){let v,C,T,l={};if(m(n)){T=A(n.from)?n.from:1;var y=n.levels;for(C={},v=m(n.defaults)?n.defaults:{},N(y)&&(C=y.reduce((I,d)=>{let c,i;return m(d)&&A(d.level)&&(i=h({},d),c=p(i.levelIsConstant,v.levelIsConstant),delete i.levelIsConstant,delete i.level,m(I[d=d.level+(c?0:T-1)])?h(!0,I[d],i):I[d]=i),I},{})),y=A(n.to)?n.to:1,n=0;n<=y;n++)l[n]=h({},v,m(C[n])?C[n]:{})}return l},setTreeValues:function Z(n,l){var v=l.before;const C=l.idRoot,y=l.points[n.i],I=y&&y.options||{},d=[];let c=0;return n.levelDynamic=n.level-(!1!==l.levelIsConstant?0:l.mapIdToNode[C].level),n.name=p(y&&y.name,""),n.visible=C===n.id||!0===l.visible,"function"==typeof v&&(n=v(n,l)),n.children.forEach((i,a)=>{const o=P({},l);P(o,{index:a,siblings:n.children.length,visible:n.visible}),i=Z(i,o),d.push(i),i.visible&&(c+=i.val)}),v=p(I.value,c),n.visible=0<=v&&(0<c||n.visible),n.children=d,n.childrenTotal=c,n.isLeaf=n.visible&&!c,n.val=v,n},updateRootId:function(n){if(m(n)){var l=m(n.options)?n.options:{};l=p(n.rootNode,l.rootId,""),m(n.userOptions)&&(n.userOptions.rootId=l),n.rootNode=l}return l}}}),U(f,"Series/Sankey/SankeySeries.js",[f["Core/Color/Color.js"],f["Core/Globals.js"],f["Series/NodesComposition.js"],f["Series/Sankey/SankeyPoint.js"],f["Series/Sankey/SankeySeriesDefaults.js"],f["Core/Series/SeriesRegistry.js"],f["Series/Sankey/SankeyColumnComposition.js"],f["Series/TreeUtilities.js"],f["Core/Utilities.js"]],function(S,O,Z,P,N,A,m,h,p){const{series:n,seriesTypes:{column:l}}=A,{getLevelOptions:v}=h,{extend:C,isObject:T,merge:y,pick:I,relativeLength:d,stableSort:c}=p;class i extends l{constructor(){super(...arguments),this.translationFactor=this.points=this.options=this.nodeWidth=this.nodes=this.nodePadding=this.nodeLookup=this.group=this.data=this.colDistance=void 0}static getDLOptions(o){const e=T(o.optionsPoint)?o.optionsPoint.dataLabels:{};return o=T(o.level)?o.level.dataLabels:{},y({style:{}},o,e)}createNodeColumns(){const o=[];this.nodes.forEach(function(e){e.setNodeColumn(),o[e.column]||(o[e.column]=m.compose([],this)),o[e.column].push(e)},this);for(let e=0;e<o.length;e++)typeof o[e]>"u"&&(o[e]=m.compose([],this));return o}order(o,e){const s=this;typeof o.level>"u"&&(o.level=e,o.linksFrom.forEach(function(r){r.toNode&&s.order(r.toNode,e+1)}))}generatePoints(){Z.generatePoints.apply(this,arguments);const o=this;this.orderNodes&&(this.nodes.filter(function(e){return 0===e.linksTo.length}).forEach(function(e){o.order(e,0)}),c(this.nodes,function(e,s){return e.level-s.level}))}getNodePadding(){let o=this.options.nodePadding||0;if(this.nodeColumns){const e=this.nodeColumns.reduce((s,r)=>Math.max(s,r.length),0);e*o>this.chart.plotSizeY&&(o=this.chart.plotSizeY/e)}return o}hasData(){return!!this.processedXData.length}pointAttribs(o,e){if(!o)return{};const s=this,r=s.mapOptionsToLevel[(o.isNode?o.level:o.fromNode.level)||0]||{},g=o.options,_=r.states&&r.states[e||""]||{};e=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce(function(M,x){return M[x]=I(_[x],g[x],r[x],s.options[x]),M},{});const u=I(_.color,g.color,e.colorByPoint?o.color:r.color);return o.isNode?{fill:u,stroke:e.borderColor,"stroke-width":e.borderWidth,opacity:e.opacity}:{fill:S.parse(u).setOpacity(e.linkOpacity).get()}}drawTracker(){l.prototype.drawTracker.call(this,this.points),l.prototype.drawTracker.call(this,this.nodes)}drawPoints(){l.prototype.drawPoints.call(this,this.points),l.prototype.drawPoints.call(this,this.nodes)}drawDataLabels(){l.prototype.drawDataLabels.call(this,this.points),l.prototype.drawDataLabels.call(this,this.nodes)}translate(){this.processedXData||this.processData(),this.generatePoints(),this.nodeColumns=this.createNodeColumns(),this.nodeWidth=d(this.options.nodeWidth,this.chart.plotSizeX);const o=this,e=this.chart,s=this.options,r=this.nodeWidth,g=this.nodeColumns;this.nodePadding=this.getNodePadding(),this.translationFactor=g.reduce((_,u)=>Math.min(_,u.sankeyColumn.getTranslationFactor(o)),1/0),this.colDistance=(e.plotSizeX-r-s.borderWidth)/Math.max(1,g.length-1),o.mapOptionsToLevel=v({from:1,levels:s.levels,to:g.length-1,defaults:{borderColor:s.borderColor,borderRadius:s.borderRadius,borderWidth:s.borderWidth,color:o.color,colorByPoint:s.colorByPoint,levelIsConstant:!0,linkColor:s.linkColor,linkLineWidth:s.linkLineWidth,linkOpacity:s.linkOpacity,states:s.states}}),g.forEach(function(_){_.forEach(function(u){o.translateNode(u,_)})},this),this.nodes.forEach(function(_){_.linksFrom.forEach(function(u){(u.weight||u.isNull)&&u.to&&(o.translateLink(u),u.allowShadow=!1)})})}translateLink(o){var e=(w,F)=>(F=w.offset(o,F)*_,Math.min(w.nodeY+F,w.nodeY+(w.shapeArgs&&w.shapeArgs.height||0)-u));let s=o.fromNode;var r=o.toNode;let g=this.chart,_=this.translationFactor,u=Math.max(o.weight*_,this.options.minLinkWidth);var M=(g.inverted?-this.colDistance:this.colDistance)*this.options.curveFactor;let x=e(s,"linksFrom");e=e(r,"linksTo");let G=s.nodeX,D=this.nodeWidth;var E=o.outgoing,b=(r=r.nodeX)>G+D;if(g.inverted&&(x=g.plotSizeY-x,e=(g.plotSizeY||0)-e,D=-D,u=-u,b=G>r),o.shapeType="path",o.linkBase=[x,x+u,e,e+u],b&&"number"==typeof e)o.shapeArgs={d:[["M",G+D,x],["C",G+D+M,x,r-M,e,r,e],["L",r+(E?D:0),e+u/2],["L",r,e+u],["C",r-M,e+u,G+D+M,x+u,G+D,x+u],["Z"]]};else if("number"==typeof e){const w=(b=G+D)+20,F=w+u,z=x+u,X=z+20,B=X+(g.plotHeight-x-u),R=B+20,Y=R+u,W=e+u,H=W+20,J=R+.7*u,Q=r-.7*u,K=b+.7*u;o.shapeArgs={d:[["M",b,x],["C",K,x,F,z-.7*u,F,X],["L",F,B],["C",F,J,K,Y,b,Y],["L",r,Y],["C",Q,Y,M=r-20-u,J,M,B],["L",M,H],["C",M,W-.7*u,Q,e,r,e],["L",r,W],["C",E=r-20,W,E,W,E,H],["L",E,B],["C",E,R,E,R,r,R],["L",b,R],["C",w,R,w,R,w,B],["L",w,X],["C",w,z,w,z,b,z],["Z"]]}}o.dlBox={x:G+(r-G+D)/2,y:x+(e-x)/2,height:u,width:0},o.tooltipPos=g.inverted?[g.plotSizeY-o.dlBox.y-u/2,g.plotSizeX-o.dlBox.x]:[o.dlBox.x,o.dlBox.y+u/2],o.y=o.plotY=1,o.x=o.plotX=1,o.color||(o.color=s.color)}translateNode(o,e){var s=this.translationFactor;const r=this.chart,g=this.options,{borderRadius:_,borderWidth:u=0}=g;var M=o.getSum();const x=Math.max(Math.round(M*s),this.options.minLinkWidth),G=Math.round(this.nodeWidth);var D=Math.round(u)%2/2,E=e.sankeyColumn.offset(o,s);if(e=Math.floor(I(E.absoluteTop,e.sankeyColumn.top(s)+E.relativeTop))+D,D=Math.floor(this.colDistance*o.column+u/2)+d(o.options.offsetHorizontal||0,G)+D,D=r.inverted?r.plotSizeX-D:D,o.sum=M){o.shapeType="roundedRect",o.nodeX=D,o.nodeY=e,M=D,s=e;let b=o.options.height||g.height||x;const w=d("object"==typeof _?_.radius:_||0,E=o.options.width||g.width||G);r.inverted&&(M=D-G,s=r.plotSizeY-e-x,E=o.options.height||g.height||G,b=o.options.width||g.width||x),o.dlOptions=i.getDLOptions({level:this.mapOptionsToLevel[o.level],optionsPoint:o.options}),o.plotX=1,o.plotY=1,o.tooltipPos=r.inverted?[r.plotSizeY-s-b/2,r.plotSizeX-M-E/2]:[M+E/2,s+b/2],o.shapeArgs={x:M,y:s,width:E,height:b,r:w,display:o.hasShape()?"":"none"}}else o.dlOptions={enabled:!1}}}return i.defaultOptions=y(l.defaultOptions,N),Z.compose(P,i),C(i.prototype,{animate:n.prototype.animate,createNode:Z.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:P,searchPoint:O.noop}),A.registerSeriesType("sankey",i),i}),U(f,"masters/modules/sankey.src.js",[],function(){})},j.exports?(f.default=f,j.exports=f):(L=[k(1845)],void 0!==(t=function(U){return f(U),f.Highcharts=U,f}.apply(q,L))&&(j.exports=t))},5861:(j,q,k)=>{function L(f,U,S,O,Z,P,N){try{var A=f[P](N),m=A.value}catch(h){return void S(h)}A.done?U(m):Promise.resolve(m).then(O,Z)}function t(f){return function(){var U=this,S=arguments;return new Promise(function(O,Z){var P=f.apply(U,S);function N(m){L(P,O,Z,N,A,"next",m)}function A(m){L(P,O,Z,N,A,"throw",m)}N(void 0)})}}k.d(q,{Z:()=>t})}}]);